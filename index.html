<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>my-private-space</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet" />
<link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet" />

<style>
:root {
  --glass-bg: rgba(255, 255, 255, 0.12);
  --glass-blur: 16px;
  --text-color: #fff;
}

body {
  margin: 0;
  height: 100vh;
  font-family: 'Roboto', sans-serif;
  color: var(--text-color);
  background: url('assets/chihiro036.jpeg') center center/cover no-repeat;
  overflow: hidden;
}

.overlay {
  position: absolute;
  inset: 0;
  background: rgba(0, 0, 0, 0.35);
}

.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(var(--glass-blur));
  border-radius: 20px;
  padding: 20px;
  margin: 20px;
  min-width: 240px;
}

.container {
  position: relative;
  z-index: 2;
  display: flex;
  justify-content: space-between;
  height: 85%;
  align-items: center;
  padding: 0 40px;
}

.center {
  text-align: center;
}

#time {
  font-size: 140px;
  font-weight: 700;
}

.date {
  font-size: 28px;
  font-weight: 400;
  margin-top: 8px;
  color: rgba(255, 255, 255, 0.85);
}

.weather, .info {
  font-size: 20px;
  line-height: 1.8;
}

/* ‚öôÔ∏è Settings Gear (Top-right) */
.gear {
  position: fixed;
  top: 20px;
  right: 20px;
  cursor: pointer;
  font-size: 28px;
  transition: transform 0.3s ease, color 0.3s ease;
  z-index: 5;
  color: rgba(255, 255, 255, 0.85);
}

.gear:hover {
  transform: rotate(90deg) scale(1.1);
  color: #fff;
}

/* ‚öôÔ∏è Settings Panel */
#settings {
  position: fixed;
  top: 70px;
  right: 20px;
  background: var(--glass-bg);
  backdrop-filter: blur(var(--glass-blur));
  border-radius: 16px;
  padding: 16px;
  display: none;
  color: white;
  min-width: 220px;
  z-index: 5;
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.25);
}

#settings label {
  display: flex;
  align-items: center;
  gap: 8px;
  margin: 6px 0;
  font-size: 16px;
}

#settings input {
  transform: scale(1.3);
}

/* üß≠ Bottom ticker and footer */
.bottom {
  position: fixed;
  bottom: 15px;
  width: 100%;
  text-align: center;
  z-index: 3;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 6px;
}

.ticker {
  white-space: nowrap;
  overflow: hidden;
  width: 75%;
  max-width: 800px;
  margin: 0 auto;
  animation: tickerScroll 18s linear infinite;
  font-size: 1.1rem;
  letter-spacing: 0.5px;
}

.ticker:hover {
  animation-play-state: paused;
}

@keyframes tickerScroll {
  0% { transform: translateX(100%); }
  100% { transform: translateX(-100%); }
}

.footer {
  font-size: 0.8rem;
  opacity: 0.7;
}
</style>
</head>

<body>
<div class="overlay"></div>

<div class="container">
  <div class="glass info" id="infoPanel">
    <div><span class="material-icons-outlined">currency_bitcoin</span> BTC: <span id="btc">...</span></div>
    <div><span class="material-icons-outlined">token</span> ETH: <span id="eth">...</span></div>
    <div><span class="material-icons-outlined">currency_exchange</span> PI: <span id="pi">...</span></div>
  </div>

  <div class="center">
    <div id="time">00:00</div>
    <div id="date" class="date">-- -- ----</div>
  </div>

  <div class="glass weather" id="weatherPanel">
    <div><span class="material-icons-outlined">cloud</span> <span id="temp">--</span>¬∞C</div>
    <div><span class="material-icons-outlined">water_drop</span> Humidity: <span id="humidity">--</span>%</div>
    <div><span class="material-icons-outlined">waves</span> Dew Point: <span id="dew">--</span>¬∞C</div>
    <div><span class="material-icons-outlined">air</span> Wind: <span id="wind">--</span> km/h</div>
    <div><span class="material-icons-outlined">speed</span> Pressure: <span id="pressure">--</span> hPa</div>
  </div>
</div>

<!-- ‚öôÔ∏è Settings Gear -->
<span class="material-icons-outlined gear" id="gearIcon">settings</span>

<!-- ‚öôÔ∏è Settings Panel -->
<div id="settings">
  <label><input type="checkbox" id="toggleInfo" checked> Show Crypto</label>
  <label><input type="checkbox" id="toggleWeather" checked> Show Weather</label>
  <label><input type="checkbox" id="toggleOneko" checked> Show Cat</label>
</div>

<!-- üß≠ Bottom Section -->
<div class="bottom">
  <div class="glass ticker" id="ticker">Welcome back, Ruben. Stay curious üí´</div>
  <div class="footer">üêæ Magic Mirror | Powered by oneko.js</div>
</div>

<script>
const WEATHER_API_KEY = "d81009d2cbae458bbdb51509251210"; // <-- replace with your key
const CITY = "Lalitpur";

// üïí Time + Date
function updateTime() {
  const now = new Date();
  document.getElementById('time').textContent = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', hour12: false });
  const options = { weekday: 'short', month: 'short', day: 'numeric', year: 'numeric' };
  document.getElementById('date').textContent = now.toLocaleDateString([], options);
}
setInterval(updateTime, 1000);
updateTime();

// üå¶ WeatherAPI
async function fetchWeather() {
  try {
    const res = await fetch(`https://api.weatherapi.com/v1/current.json?key=${WEATHER_API_KEY}&q=${CITY}`);
    const data = await res.json();
    document.getElementById('temp').textContent = data.current.temp_c.toFixed(1);
    document.getElementById('humidity').textContent = data.current.humidity;
    document.getElementById('dew').textContent = data.current.dewpoint_c.toFixed(1);
    document.getElementById('wind').textContent = data.current.wind_kph;
    document.getElementById('pressure').textContent = data.current.pressure_mb;
  } catch(err) {
    console.error("Weather error:", err);
  }
}
fetchWeather();
setInterval(fetchWeather, 30*60*1000);

// üíπ Crypto Prices
async function fetchCrypto() {
  try {
    const res = await fetch("https://api.coingecko.com/api/v3/simple/price?ids=bitcoin,ethereum,pi-network&vs_currencies=usd");
    const data = await res.json();
    document.getElementById('btc').textContent = "$" + data.bitcoin.usd.toLocaleString();
    document.getElementById('eth').textContent = "$" + data.ethereum.usd.toLocaleString();
    document.getElementById('pi').textContent = "$" + data["pi-network"].usd.toLocaleString();
  } catch(err) {
    console.error("Crypto error:", err);
  }
}
fetchCrypto();
setInterval(fetchCrypto, 60*1000);

// ‚öô Settings Panel
const gear = document.getElementById('gearIcon');
const settings = document.getElementById('settings');
const toggles = {
  info: document.getElementById('toggleInfo'),
  weather: document.getElementById('toggleWeather'),
  oneko: document.getElementById('toggleOneko')
};

// Load saved states
Object.keys(toggles).forEach(key => {
  const saved = localStorage.getItem(`show_${key}`);
  if(saved !== null) toggles[key].checked = saved === 'true';
});

function applyToggles() {
  document.getElementById('infoPanel').style.display = toggles.info.checked ? 'block' : 'none';
  document.getElementById('weatherPanel').style.display = toggles.weather.checked ? 'block' : 'none';
  Object.keys(toggles).forEach(key => localStorage.setItem(`show_${key}`, toggles[key].checked));
  applyOnekoToggle();
}
Object.values(toggles).forEach(input => input.addEventListener('change', applyToggles));
gear.addEventListener('click', () => {
  settings.style.display = settings.style.display === 'block' ? 'none' : 'block';
});

// üêæ Oneko Cat
const ONEKO_SRC = "https://cdn.jsdelivr.net/gh/adryd325/oneko.js/oneko.js";
const ONEKO_CAT = "https://cdn.jsdelivr.net/gh/adryd325/oneko.js/oneko.gif";
let onekoActive = false;
let onekoScriptEl = null;

function startOneko() {
  if(onekoActive) return;
  onekoActive = true;
  onekoScriptEl = document.createElement("script");
  onekoScriptEl.src = ONEKO_SRC;
  onekoScriptEl.dataset.cat = ONEKO_CAT;
  onekoScriptEl.onload = () => { try { window.oneko && window.oneko(); } catch{} };
  document.body.appendChild(onekoScriptEl);
}

function stopOneko() {
  onekoActive = false;
  if(onekoScriptEl) onekoScriptEl.remove();
  document.querySelectorAll("canvas").forEach(c => c.remove());
  try { delete window.oneko; } catch { window.oneko = undefined; }
}

function applyOnekoToggle() {
  if(toggles.oneko.checked) startOneko();
  else stopOneko();
}

applyToggles();
</script>
</body>
</html>
