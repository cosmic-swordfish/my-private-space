<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>my-private-space</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet">
<style>
:root {
  --md-sys-primary: #6750A4;
  --md-sys-on-primary: #FFFFFF;
  --md-sys-surface: rgba(255,255,255,0.1);
  --md-sys-on-surface: #FFFFFF;
  --md-sys-surface-variant: rgba(255,255,255,0.08);
  --glass-blur: 16px;
}

body {
  margin:0; font-family:'Roboto',sans-serif; color:var(--md-sys-on-surface);
  background: url('assets/chihiro036.jpeg') center/cover no-repeat; overflow:hidden; position:relative;
}
.overlay { position:absolute; inset:0; background: rgba(0,0,0,0.35); z-index:1; }

/* Glass Panels with M3 elevation */
.glass {
  background: var(--md-sys-surface);
  backdrop-filter: blur(var(--glass-blur));
  border-radius: 28px;
  padding: 20px;
  color: var(--md-sys-on-surface);
  z-index:2;
  opacity:1;
  transition: opacity 0.5s ease, transform 0.5s ease, background 0.3s ease;
  box-shadow: 0 4px 16px rgba(0,0,0,0.3);
  font-size: 1rem;
}

/* Panels */
.container { position:relative; width:100%; height:100%; display:flex; justify-content:center; align-items:center; flex-direction:column; }
.panel-left, .panel-right { display:flex; flex-direction:column; gap:12px; position:absolute; top:50%; transform:translateY(-50%); min-width:200px; }
.panel-left { left:20px; } .panel-right { right:20px; }
.panel-left div, .panel-right div { display:flex; justify-content:space-between; align-items:center; padding:6px 0; font-weight:500; }
.panel-left div span.icon, .panel-right div span.icon { margin-right:8px; font-size:1.3rem; display:inline-flex; align-items:center; color:var(--md-sys-primary); }

/* Center Time & Date */
.center { text-align:center; z-index:3; }
#time { font-size:140px; font-weight:700; line-height:1; }
.date { font-size:28px; font-weight:500; margin-top:6px; color: rgba(255,255,255,0.85); }

/* Pomodoro Timer */
#pomodoro { margin-top:20px; display:flex; justify-content:center; align-items:center; gap:14px; flex-wrap:wrap; }
#pomodoro select, #pomodoro button, #pomodoro div#pomodoroTime {
  padding:8px 16px; font-size:1rem; border:none; border-radius:24px;
  background: var(--md-sys-surface-variant); color:var(--md-sys-on-surface); cursor:pointer; transition: all 0.3s;
  box-shadow: 0 2px 6px rgba(0,0,0,0.2);
}
#pomodoro select:hover, #pomodoro button:hover { background: var(--md-sys-primary); color: var(--md-sys-on-primary); }
#pomodoroTime { min-width:80px; text-align:center; font-weight:600; background: var(--md-sys-surface); }

/* Gear + Settings */
.gear { position:fixed; top:20px; right:20px; cursor:pointer; font-size:28px; transition: transform 0.3s ease,color 0.3s ease; z-index:5; color: rgba(255,255,255,0.85);}
.gear:hover { transform: rotate(90deg) scale(1.1); color: var(--md-sys-primary); }
#settings { position:fixed; top:70px; right:20px; background: var(--md-sys-surface); backdrop-filter: blur(var(--glass-blur)); border-radius:28px; padding:16px; display:block; min-width:220px; z-index:6; box-shadow:0 4px 16px rgba(0,0,0,0.3); opacity:0; transform:translateY(-20px); pointer-events:none; transition:opacity 0.5s ease, transform 0.5s ease;}
#settings.show { opacity:1; transform:translateY(0); pointer-events:all; }
#settings label { display:flex; align-items:center; gap:10px; margin:6px 0; font-size:16px; }
#settings input { transform: scale(1.3); }

/* Bottom ticker */
.bottom { position:fixed; bottom:15px; width:100%; text-align:center; z-index:3; display:flex; flex-direction:column; align-items:center; gap:6px; }
.ticker { white-space:nowrap; overflow:hidden; width:75%; max-width:800px; margin:0 auto; animation:tickerScroll 18s linear infinite; font-size:1.1rem; letter-spacing:0.5px; }
.ticker:hover { animation-play-state:paused; }
@keyframes tickerScroll { 0%{transform:translateX(100%);} 100%{transform:translateX(-100%);} }
.footer { font-size:0.8rem; opacity:0.7; }

/* Notification Snackbar */
#notification {
  position:fixed; bottom:30px; right:30px; background: var(--md-sys-primary);
  color: var(--md-sys-on-primary); padding:14px 24px; border-radius:28px;
  opacity:0; transform:translateY(20px); pointer-events:none;
  box-shadow: 0 4px 16px rgba(0,0,0,0.3);
  transition: opacity 0.4s ease, transform 0.4s ease;
  font-weight:500; z-index:100;
}
#notification.show { opacity:1; transform:translateY(0); pointer-events:auto; }

/* Responsive */
@media(max-width:900px){ .panel-left,.panel-right{position:static; transform:none; width:90%; margin:8px auto; text-align:center;}}
@media(max-width:600px){#time{font-size:70px;} .date{font-size:18px;} #pomodoro{flex-direction:column; gap:8px;} .panel-left,.panel-right{font-size:0.75rem; padding:8px;}}
/* Oneko scaling */
@media(max-width:900px){canvas{transform:scale(0.7)!important; transform-origin:left bottom!important;}}
@media(max-width:600px){canvas{transform:scale(0.5)!important; transform-origin:left bottom!important;}}
</style>
</head>
<body>
<div class="overlay"></div>
<div class="container">
  <!-- Crypto Panel -->
  <div class="glass panel-left" id="infoPanel">
    <div><span class="material-icons-outlined icon">currency_bitcoin</span><span id="btc">BTC: ...</span></div>
    <div><span class="material-icons-outlined icon">token</span><span id="eth">ETH: ...</span></div>
    <div><span class="material-icons-outlined icon">currency_exchange</span><span id="pi">PI: ...</span></div>
  </div>

  <!-- Center Time + Pomodoro -->
  <div class="center">
    <div id="time">00:00</div>
    <div id="date" class="date">-- -- ----</div>
    <div id="pomodoro">
      <select id="pomSelect">
        <option value="5">5 min</option>
        <option value="10">10 min</option>
        <option value="15">15 min</option>
        <option value="20">20 min</option>
        <option value="25" selected>25 min</option>
      </select>
      <div id="pomodoroTime">25:00</div>
      <button id="startPom">Start</button>
      <button id="resetPom">Reset</button>
    </div>
  </div>

  <!-- Weather Panel -->
  <div class="glass panel-right" id="weatherPanel">
    <div><span class="material-icons-outlined icon">cloud</span><span id="temp">--¬∞C</span></div>
    <div><span class="material-icons-outlined icon">water_drop</span><span id="humidity">Humidity: --%</span></div>
    <div><span class="material-icons-outlined icon">waves</span><span id="dew">Dew: --¬∞C</span></div>
    <div><span class="material-icons-outlined icon">air</span><span id="wind">Wind: -- km/h</span></div>
    <div><span class="material-icons-outlined icon">speed</span><span id="pressure">Pressure: -- hPa</span></div>
  </div>
</div>

<!-- Gear + Settings -->
<span class="material-icons-outlined gear" id="gearIcon">settings</span>
<div id="settings">
  <label><input type="checkbox" id="toggleInfo" checked> Show Crypto</label>
  <label><input type="checkbox" id="toggleWeather" checked> Show Weather</label>
  <label><input type="checkbox" id="toggleOneko" checked> Show Cat</label>
</div>

<!-- Bottom ticker -->
<div class="bottom">
  <div class="glass ticker" id="ticker">Welcome back, Ruben. Stay curious üí´</div>
  <div class="footer">üêæ Magic Mirror | Powered by oneko.js</div>
</div>

<!-- Notification -->
<div id="notification">Pomodoro finished! ‚è∞</div>

<!-- Notification sound -->
<audio id="notifSound" src="https://actions.google.com/sounds/v1/alarms/alarm_clock.ogg" preload="auto"></audio>

<script>
// Time
function updateTime(){const now=new Date(); document.getElementById('time').textContent=now.toLocaleTimeString([], {hour:'2-digit',minute:'2-digit',hour12:false}); const options={ weekday:'short', month:'short', day:'numeric', year:'numeric' }; document.getElementById('date').textContent=now.toLocaleDateString([], options);}
setInterval(updateTime,1000); updateTime();

// Weather
const WEATHER_API_KEY="d81009d2cbae458bbdb51509251210"; const CITY="Lalitpur";
async function fetchWeather(){try{const res=await fetch(`https://api.weatherapi.com/v1/current.json?key=${WEATHER_API_KEY}&q=${CITY}`); const data=await res.json(); document.getElementById('temp').textContent=data.current.temp_c.toFixed(1)+"¬∞C"; document.getElementById('humidity').textContent="Humidity: "+data.current.humidity+"%"; document.getElementById('dew').textContent="Dew: "+(data.current.dewpoint_c??0).toFixed(1)+"¬∞C"; document.getElementById('wind').textContent="Wind: "+data.current.wind_kph+" km/h"; document.getElementById('pressure').textContent="Pressure: "+data.current.pressure_mb+" hPa"; }catch(e){console.error("Weather error:",e);}}
fetchWeather(); setInterval(fetchWeather,30*60*1000);

// Crypto
async function fetchCrypto(){try{const res=await fetch("https://api.coingecko.com/api/v3/simple/price?ids=bitcoin,ethereum,pi-network&vs_currencies=usd"); const data=await res.json(); document.getElementById('btc').textContent="BTC: $"+data.bitcoin.usd.toLocaleString(); document.getElementById('eth').textContent="ETH: $"+data.ethereum.usd.toLocaleString(); document.getElementById('pi').textContent="PI: $"+data["pi-network"].usd.toLocaleString(); }catch(e){console.error("Crypto error:",e);}}
fetchCrypto(); setInterval(fetchCrypto,60*1000);

// Settings & Toggles
const gear=document.getElementById('gearIcon'); const settings=document.getElementById('settings');
const toggles={ info:document.getElementById('toggleInfo'), weather:document.getElementById('toggleWeather'), oneko:document.getElementById('toggleOneko')};
Object.keys(toggles).forEach(k=>{const saved=localStorage.getItem(`show_${k}`); if(saved!==null) toggles[k].checked=saved==='true';});
function fadeSlidePanel(el, show){ el.style.opacity=show?'1':'0'; el.style.transform=show?'translateY(0)':'translateY(20px)'; el.style.pointerEvents=show?'all':'none'; }
function fadeOneko(show){document.querySelectorAll("canvas").forEach(c=>{c.style.transition="opacity 0.5s ease"; c.style.opacity=show?'1':'0'; c.style.pointerEvents=show?'all':'none';});}
function applyOnekoToggle(){ toggles.oneko.checked ? startOneko() : stopOneko(); }
function applyToggles(){ fadeSlidePanel(document.getElementById('infoPanel'), toggles.info.checked); fadeSlidePanel(document.getElementById('weatherPanel'), toggles.weather.checked); fadeOneko(toggles.oneko.checked); Object.keys(toggles).forEach(k=>localStorage.setItem(`show_${k}`, toggles[k].checked)); }
Object.values(toggles).forEach(i=>i.addEventListener('change',applyToggles));
gear.addEventListener('click',()=>{settings.classList.toggle('show');});

// Oneko
const ONEKO_SRC="https://cdn.jsdelivr.net/gh/adryd325/oneko.js/oneko.js"; const ONEKO_CAT="https://cdn.jsdelivr.net/gh/adryd325/oneko.js/oneko.gif";
let onekoActive=false,onekoScriptEl=null;
function startOneko(){ if(onekoActive) return; onekoActive=true; if(!window.oneko){onekoScriptEl=document.createElement("script"); onekoScriptEl.src=ONEKO_SRC; onekoScriptEl.dataset.cat=ONEKO_CAT; onekoScriptEl.onload=()=>{try{window.oneko(); applyOnekoResponsive(); fadeOneko(true);}catch{} }; document.body.appendChild(onekoScriptEl);} else fadeOneko(true); }
function stopOneko(){ onekoActive=false; fadeOneko(false); }
function applyOnekoResponsive(){ document.querySelectorAll("canvas").forEach(c=>{ const w=window.innerWidth; c.style.transform=w<=600?"scale(0.5)":w<=900?"scale(0.7)":"scale(1)"; c.style.transformOrigin="left bottom";}); }
window.addEventListener('resize',()=>{ if(onekoActive) applyOnekoResponsive(); });
applyToggles();

// Pomodoro with notification
let pomTime=25*60, pomInterval=null;
const pomDisplay=document.getElementById('pomodoroTime');
const pomSelect=document.getElementById('pomSelect');
const notification=document.getElementById('notification');
const notifSound=document.getElementById('notifSound');

function showNotification(msg){
  notification.textContent=msg;
  notification.classList.add('show');
  notifSound.play().catch(()=>{});
  setTimeout(()=>{notification.classList.remove('show');},4000);
}

function updatePomTime(){ pomTime=parseInt(pomSelect.value)*60; pomDisplay.textContent=`${pomSelect.value.toString().padStart(2,'0')}:00`; }
pomSelect.addEventListener('change',()=>{ clearInterval(pomInterval); pomInterval=null; updatePomTime(); });
document.getElementById('startPom').addEventListener('click',()=>{
  if(pomInterval) return;
  pomInterval=setInterval(()=>{
    if(pomTime<=0){ clearInterval(pomInterval); pomInterval=null; showNotification("Pomodoro finished! ‚è∞"); return; }
    pomTime--; let m=Math.floor(pomTime/60); let s=pomTime%60;
    pomDisplay.textContent=`${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
  },1000);
});
document.getElementById('resetPom').addEventListener('click',()=>{ clearInterval(pomInterval); pomInterval=null; updatePomTime(); });
updatePomTime();
</script>
</body>
</html>
